<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>German Learning Hub</title>
    <meta name="description" content="Your comprehensive platform for learning German vocabulary, grammar, and pronunciation">
    <meta name="theme-color" content="#667eea">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="German Hub">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iNDAiIGZpbGw9InVybCgjZ3JhZGllbnQwXzFfMikiLz4KPGREZWZZPGO8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF8xXzIiIHgxPSIwIiB5MT0iMCIgeDI9IjE5MiIgeTI9IjE5MiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjNjY3ZWVhIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzc2NGJhMiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+Cjx0ZXh0IHg9Ijk2IiB5PSIxMjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI5NiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn4et8J+HqzwvdGV4dD4KPC9zdmc+">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzIiIGhlaWdodD0iNzIiIHZpZXdCb3g9IjAgMCA3MiA3MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjcyIiBoZWlnaHQ9IjcyIiByeD0iMTYiIGZpbGw9InVybCgjZ3JhZGllbnQwXzFfMikiLz4KPGREZWZZPGO8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF8xXzIiIHgxPSIwIiB5MT0iMCIgeDI9IjcyIiB5Mj0iNzIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzY2N2VlYSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM3NjRiYTIiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8dGV4dCB4PSIzNiIgeT0iNDUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIzNiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn4et8J+HqzwvdGV4dD4KPC9zdmc+">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        /* Header with Navigation */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            height: 70px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }
        
        .logo .flag {
            margin-right: 10px;
            font-size: 28px;
        }
        
        /* Desktop Navigation */
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-menu a:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Mobile Hamburger */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 5px;
        }
        
        .hamburger span {
            width: 25px;
            height: 3px;
            background: #495057;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }
        
        .hamburger.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }
        
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* Search Box Styles */
        .search-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            justify-content: center;
            max-width: 500px;
            margin: 0 20px;
            position: relative;
        }
        
        .search-box {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .search-box:focus {
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .search-box::placeholder {
            color: #6c757d;
        }
        
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
            margin-top: 10px;
        }
        
        .search-result-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f8f9fa;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .search-result-item:hover {
            background-color: #f8f9fa;
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .search-result-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .search-result-content {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .search-result-page {
            color: #667eea;
            font-size: 12px;
            font-weight: 500;
        }
        
        .no-results {
            padding: 20px;
            text-align: center;
            color: #6c757d;
        }
        
        /* Mobile Menu Overlay */
        .mobile-menu {
            position: fixed;
            top: 70px;
            left: -100%;
            width: 100%;
            height: calc(100vh - 70px);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            transition: left 0.3s ease;
            z-index: 999;
            overflow-y: auto;
        }
        
        .mobile-menu.active {
            left: 0;
        }
        
        .mobile-nav-list {
            list-style: none;
            padding: 20px;
        }
        
        .mobile-nav-list li {
            margin: 10px 0;
        }
        
        .mobile-nav-list a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #495057;
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .mobile-nav-list a:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        /* Main Content Area */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .hero-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
        
        .hero-section h1 {
            font-size: 3rem;
            color: #495057;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero-section p {
            font-size: 1.2rem;
            color: #6c757d;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            color: #495057;
            border: 2px solid #e9ecef;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        /* Features Grid */
        .features-section {
            margin: 60px 0;
        }
        
        .section-title {
            text-align: center;
            color: white;
            font-size: 2.5rem;
            margin-bottom: 40px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 40px 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }
        
        .feature-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .feature-card p {
            color: #6c757d;
            line-height: 1.6;
        }
        
        .feature-card .btn {
            margin-top: 20px;
            padding: 12px 24px;
            font-size: 14px;
        }
        
        /* Stats Section */
        .stats-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            text-align: center;
        }
        
        .stat-item {
            padding: 20px;
        }
        
        .stat-number {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: block;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 1.1rem;
            margin-top: 10px;
        }
        
        /* Install Banner */
        .install-banner {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            display: none;
        }
        
        .install-banner.show {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.2);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 60px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hamburger {
                display: flex;
            }
            
            .search-container {
                margin: 0 10px;
                max-width: none;
                flex: 1;
            }
            
            .search-box {
                font-size: 14px;
                padding: 10px 15px;
            }
            
            .hero-section {
                padding: 40px 20px;
            }
            
            .hero-section h1 {
                font-size: 2rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .feature-card {
                padding: 30px 20px;
            }
        }
        
        @media (max-width: 480px) {
            .main-content {
                padding: 20px 10px;
            }
            
            .hero-section {
                padding: 30px 15px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
            
            .stat-number {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Navigation -->
    <header class="header">
        <nav class="nav-container">
            <a href="index.html" class="logo">
                <span class="flag">🇩🇪</span>
                German Hub
            </a>
            
            <!-- Search Container -->
            <div class="search-container">
                <input type="text" 
                       class="search-box" 
                       id="globalSearch" 
                       placeholder="🔍 Search German words, phrases, or pages..."
                       onkeyup="performSearch(this.value)"
                       autocomplete="off">
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <!-- Desktop Navigation -->
            <ul class="nav-menu">
                <li><a href="content/vocabulary/index.html">📚 Vocabulary</a></li>
                <li><a href="content/grammar/index.html">📖 Grammar</a></li>
                <li><a href="#" onclick="showUnderConstructionAlert('Practice'); return false;">🎯 Practice</a></li>
                <li><a href="#" onclick="showUnderConstructionAlert('Tools'); return false;">⚙️ Tools</a></li>
            </ul>
            
            <!-- Mobile Hamburger -->
            <div class="hamburger" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
        
        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu" id="mobileMenu">
            <ul class="mobile-nav-list">
                <li><a href="content/vocabulary/index.html">📚 Vocabulary</a></li>
                <li><a href="content/grammar/index.html">📖 Grammar</a></li>
                <li><a href="#" onclick="showUnderConstructionAlert('Practice'); return false;">🎯 Practice</a></li>
                <li><a href="#" onclick="showUnderConstructionAlert('Tools'); return false;">⚙️ Tools</a></li>
            </ul>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero-section">
            <h1>Guten Tag! 👋</h1>
            <p>Your comprehensive platform for learning German vocabulary, grammar, and pronunciation. Master the language with interactive content, responsive tables, and offline access.</p>
            <div class="cta-buttons">
                <a href="content/vocabulary/index.html" class="btn btn-primary">
                    📚 Start Learning Vocabulary
                </a>
                <a href="#" onclick="showUnderConstructionAlert('Practice'); return false;" class="btn btn-secondary">
                    🎯 Take a Practice Quiz
                </a>
            </div>
        </section>

        <!-- Install Banner (PWA) -->
        <div class="install-banner" id="installBanner">
            <h3>📱 Install German Hub</h3>
            <p>Add this app to your home screen for offline access and a native app experience!</p>
            <button class="btn btn-secondary" onclick="installPWA()">Install App</button>
            <button class="btn btn-secondary" onclick="dismissInstallBanner()" style="margin-left: 10px;">Maybe Later</button>
        </div>

        <!-- Stats Section -->
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">200+</span>
                    <div class="stat-label">Vocabulary Words</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">4</span>
                    <div class="stat-label">Learning Categories</div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <h2 class="section-title">🚀 Learning Features</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <span class="feature-icon">📚</span>
                    <h3>Comprehensive Vocabulary</h3>
                    <p>W-words, professions, food & drinks, city locations - all with pronunciation guides and memory tips.</p>
                    <a href="content/vocabulary/index.html" class="btn btn-primary">Explore Vocabulary</a>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">📖</span>
                    <h3>Grammar Made Easy</h3>
                    <p>Master German grammar with irregular verbs, articles (der/die/das), and sentence structure. Comprehensive guides with examples and conjugation tables.</p>
                    <a href="content/grammar/index.html" class="btn btn-primary">Learn Grammar</a>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">🎯</span>
                    <h3>Interactive Practice</h3>
                    <p>Test your knowledge with quizzes and flashcards. Track your progress as you learn.</p>
                    <a href="#" onclick="showUnderConstructionAlert('Practice'); return false;" class="btn btn-primary">Start Practicing</a>
                </div>
                
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 German Learning Hub. Built with ❤️ for language learners.</p>
        <p>📧 Feedback? <a href="mailto:feedback@germanhub.com" style="color: #20c997;">Let us know!</a> | 
        <button onclick="refreshCache()" style="background: none; border: none; color: #20c997; cursor: pointer; text-decoration: underline; font-size: inherit;">🔄 Refresh App</button></p>
    </footer>

    <script>
        // Under Construction Alert
        function showUnderConstructionAlert(sectionName) {
            alert(`🚧 ${sectionName} Section Under Construction 🚧\n\nThis section is currently being developed and will be available soon!\n\nStay tuned for exciting German learning tools and practice exercises.`);
        }

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const hamburger = document.querySelector('.hamburger');
            const mobileMenu = document.getElementById('mobileMenu');
            
            hamburger.classList.toggle('active');
            mobileMenu.classList.toggle('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileMenu = document.getElementById('mobileMenu');
            const hamburger = document.querySelector('.hamburger');
            const navContainer = document.querySelector('.nav-container');
            
            if (!navContainer.contains(event.target) && mobileMenu.classList.contains('active')) {
                hamburger.classList.remove('active');
                mobileMenu.classList.remove('active');
            }
        });

        // PWA Installation Debug
        let deferredPrompt;
        let installButton;
        let installPromptAvailable = false;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('✅ PWA install prompt available!');
            e.preventDefault();
            deferredPrompt = e;
            installPromptAvailable = true;
            showInstallBanner();
        });
        
        // Check if PWA can be installed (more reliable detection)
        window.addEventListener('load', () => {
            setTimeout(() => {
                // Check if already installed
                if (window.navigator.standalone || window.matchMedia('(display-mode: standalone)').matches) {
                    console.log('📱 App already installed or running in standalone mode');
                    return;
                }
                
                // Try to trigger install prompt through user interaction
                if (!installPromptAvailable) {
                    console.log('💡 Install prompt not automatically triggered - showing banner anyway');
                    showInstallBanner();
                    
                    // Also try to detect if browser supports PWA installation
                    detectPWASupport();
                }
            }, 3000);
        });

        function detectPWASupport() {
            // Check various browser capabilities
            const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
            const isEdge = /Edge/.test(navigator.userAgent);
            const isFirefox = /Firefox/.test(navigator.userAgent);
            const isSafari = /Safari/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor);
            const isAndroid = /Android/.test(navigator.userAgent);
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            console.log('🔍 Browser Detection:');
            console.log('Chrome:', isChrome);
            console.log('Edge:', isEdge);
            console.log('Firefox:', isFirefox);
            console.log('Safari:', isSafari);
            console.log('Android:', isAndroid);
            console.log('iOS:', isIOS);
            
            // Check if service worker is properly registered
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.ready.then(registration => {
                    console.log('✅ Service Worker ready:', registration.scope);
                    
                    // For Chrome/Edge, try to manually check PWA criteria
                    if (isChrome || isEdge) {
                        checkChromeInstallability();
                    }
                });
            }
        }

        function checkChromeInstallability() {
            // Check if the page meets PWA criteria
            const manifest = document.querySelector('link[rel="manifest"]');
            const serviceWorker = 'serviceWorker' in navigator;
            const isSecure = location.protocol === 'https:' || location.hostname === 'localhost';
            
            console.log('🔍 PWA Criteria Check:');
            console.log('Manifest:', manifest ? '✅' : '❌');
            console.log('Service Worker:', serviceWorker ? '✅' : '❌');
            console.log('Secure Context:', isSecure ? '✅' : '❌');
            
            if (manifest && serviceWorker && isSecure) {
                console.log('✅ PWA criteria met - browser should show install option');
                
                // Update install banner to be more prominent
                const banner = document.getElementById('installBanner');
                if (banner && banner.classList.contains('show')) {
                    const installBtn = banner.querySelector('button');
                    if (installBtn) {
                        installBtn.textContent = '📱 Install App (PWA Ready!)';
                        installBtn.style.animation = 'pulse 2s infinite';
                    }
                }
            } else {
                console.log('❌ PWA criteria not fully met');
            }
        }

        function showInstallBanner() {
            const banner = document.getElementById('installBanner');
            if (banner) {
                banner.classList.add('show');
                console.log('📱 Install banner shown');
            }
        }

        function dismissInstallBanner() {
            const banner = document.getElementById('installBanner');
            if (banner) {
                banner.classList.remove('show');
                localStorage.setItem('installBannerDismissed', 'true');
            }
        }

        async function installPWA() {
            if (deferredPrompt) {
                // Native installation prompt available
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response to the install prompt: ${outcome}`);
                deferredPrompt = null;
                dismissInstallBanner();
            } else {
                // No native prompt - try alternative methods
                console.log('❌ No native install prompt available.');
                
                // Check if we can trigger installation through other means
                if (window.navigator.standalone !== undefined) {
                    // iOS Safari
                    showIOSInstallInstructions();
                } else if (window.chrome && window.chrome.webstore) {
                    // Chrome - check if install button might be available
                    showChromeInstallHelp();
                } else {
                    // Generic fallback
                    showGenericInstallHelp();
                }
            }
        }

        function showIOSInstallInstructions() {
            const modal = createInstallModal(`
                <div style="text-align: center; padding: 20px;">
                    <h3>📱 Install on iOS</h3>
                    <p>To install this app on your iPhone/iPad:</p>
                    <ol style="text-align: left; margin: 20px 0;">
                        <li>Tap the <strong>Share</strong> button <span style="font-size: 20px;">⬆️</span></li>
                        <li>Scroll down and tap <strong>"Add to Home Screen"</strong></li>
                        <li>Tap <strong>"Add"</strong> to confirm</li>
                    </ol>
                    <p>The app will appear on your home screen like a native app!</p>
                </div>
            `);
        }

        function showChromeInstallHelp() {
            const modal = createInstallModal(`
                <div style="text-align: center; padding: 20px;">
                    <h3>🔧 Install on Chrome</h3>
                    <p>To install this app:</p>
                    <ol style="text-align: left; margin: 20px 0;">
                        <li>Look for an <strong>Install</strong> icon in the address bar</li>
                        <li>Or click the <strong>⋮</strong> menu → <strong>"Install German Hub"</strong></li>
                        <li>Click <strong>"Install"</strong> to confirm</li>
                    </ol>
                    <p>If you don't see these options, try refreshing the page!</p>
                </div>
            `);
        }

        function showGenericInstallHelp() {
            const modal = createInstallModal(`
                <div style="text-align: center; padding: 20px;">
                    <h3>📱 Install This App</h3>
                    <p>To install this app on your device:</p>
                    <div style="text-align: left; margin: 20px 0;">
                        <p><strong>Chrome/Edge:</strong> Look for "Install" button in address bar or Menu → "Install App"</p>
                        <p><strong>Firefox:</strong> Menu → "Install This Site as App"</p>
                        <p><strong>Safari (iOS):</strong> Share button → "Add to Home Screen"</p>
                        <p><strong>Samsung Internet:</strong> Menu → "Add page to" → "Home screen"</p>
                    </div>
                    <p>This will create a standalone app icon on your device!</p>
                </div>
            `);
        }

        function createInstallModal(content) {
            // Create modal overlay
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                border-radius: 15px;
                max-width: 400px;
                margin: 20px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            
            modalContent.innerHTML = content + `
                <div style="padding: 20px; text-align: center; border-top: 1px solid #eee;">
                    <button onclick="this.closest('.install-modal').remove()" style="
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 8px;
                        font-size: 16px;
                        cursor: pointer;
                        font-weight: 600;
                    ">Got It!</button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            modal.className = 'install-modal';
            document.body.appendChild(modal);
            
            // Close on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            return modal;
        }

        // PWA Installation Status Check
        function checkPWAStatus() {
            console.log('🔍 PWA Status Check:');
            console.log('HTTPS:', location.protocol === 'https:');
            console.log('Service Worker Support:', 'serviceWorker' in navigator);
            console.log('Manifest:', document.querySelector('link[rel="manifest"]') ? 'Found' : 'Missing');
            
            // Check if app is already installed
            window.addEventListener('appinstalled', () => {
                console.log('✅ PWA installed successfully!');
                dismissInstallBanner();
            });
            
            // Check service worker registration
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    console.log('Service Workers:', registrations.length > 0 ? 'Registered' : 'Not found');
                    if (registrations.length === 0) {
                        console.log('⚠️ Service worker not registered yet');
                    }
                });
            }
        }

        // Check if install banner was previously dismissed
        window.addEventListener('load', () => {
            checkPWAStatus();
            
            if (localStorage.getItem('installBannerDismissed') === 'true') {
                const banner = document.getElementById('installBanner');
                if (banner) {
                    banner.style.display = 'none';
                }
            }
            
            // Enhanced debugging for PWA installation
            setTimeout(() => {
                if (!deferredPrompt) {
                    console.log('💡 Install prompt not triggered. Possible reasons:');
                    console.log('1. Site not served over HTTPS (except localhost)');
                    console.log('2. App already installed');
                    console.log('3. Browser doesn\'t support PWA installation');
                    console.log('4. PWA criteria not fully met');
                    console.log('Current URL:', window.location.href);
                    console.log('Is HTTPS:', window.location.protocol === 'https:');
                    console.log('Is localhost:', window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');
                }
            }, 3000);
        });

        // Register Service Worker with better error handling
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service_worker.js')
                    .then((registration) => {
                        console.log('✅ SW registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            console.log('🔄 SW update found');
                            showUpdateNotification();
                        });
                    })
                    .catch((registrationError) => {
                        console.error('❌ SW registration failed:', registrationError);
                    });
            });
        }

        // Cache refresh functionality
        async function refreshCache() {
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.ready;
                    if (registration.active) {
                        // Create a message channel
                        const messageChannel = new MessageChannel();
                        
                        // Listen for response
                        messageChannel.port1.onmessage = function(event) {
                            if (event.data.success) {
                                console.log('✅ Cache refreshed successfully');
                                showCacheRefreshSuccess();
                                // Reload page to get fresh content
                                setTimeout(() => window.location.reload(), 1000);
                            } else {
                                console.error('❌ Cache refresh failed:', event.data.error);
                                showCacheRefreshError();
                            }
                        };
                        
                        // Send message to service worker
                        registration.active.postMessage(
                            { type: 'FORCE_CACHE_REFRESH' },
                            [messageChannel.port2]
                        );
                    }
                } catch (error) {
                    console.error('Cache refresh error:', error);
                    showCacheRefreshError();
                }
            }
        }

        function showUpdateNotification() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.2);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
            `;
            notification.innerHTML = `
                🔄 App updated! 
                <button onclick="refreshCache()" style="
                    background: rgba(255,255,255,0.2);
                    color: white;
                    border: none;
                    padding: 5px 10px;
                    border-radius: 5px;
                    margin-left: 10px;
                    cursor: pointer;
                ">Refresh</button>
                <button onclick="this.parentElement.remove()" style="
                    background: none;
                    color: white;
                    border: none;
                    float: right;
                    cursor: pointer;
                    font-size: 18px;
                ">×</button>
            `;
            document.body.appendChild(notification);
        }

        function showCacheRefreshSuccess() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.2);
                z-index: 10000;
                font-weight: 500;
            `;
            message.innerHTML = '✅ Cache refreshed! Page will reload...';
            document.body.appendChild(message);
            
            setTimeout(() => {
                if (message.parentElement) {
                    message.parentElement.removeChild(message);
                }
            }, 3000);
        }

        function showCacheRefreshError() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.2);
                z-index: 10000;
                font-weight: 500;
            `;
            message.innerHTML = '❌ Cache refresh failed. Please try reloading the page.';
            document.body.appendChild(message);
            
            setTimeout(() => {
                if (message.parentElement) {
                    message.parentElement.removeChild(message);
                }
            }, 5000);
        }

        // Offline Status Check
        function checkOfflineStatus() {
            if (navigator.onLine) {
                alert('✅ Online: You\'re connected to the internet.\n🔄 The app will also work offline once cached!\n\n📊 PWA Status: Check browser console for details.');
            } else {
                alert('📱 Offline: You\'re browsing offline!\n✨ All content is still accessible thanks to PWA technology.\n\n🎉 This proves the offline functionality works!');
            }
            checkPWAStatus();
        }

        // Update online/offline status
        window.addEventListener('online', () => {
            console.log('Back online');
        });

        window.addEventListener('offline', () => {
            console.log('Gone offline');
        });

        // Global Search Functionality
        let searchIndex = null;
        let searchTimeout = null;

        // Content mapping for all pages in the application
        const pageContent = {
            'index.html': {
                title: 'German Learning Hub - Home',
                content: 'German Learning Hub vocabulary grammar practice tools comprehensive platform learning words phrases pronunciation interactive content responsive tables offline access Guten Tag vocabulary words learning categories',
                url: 'index.html'
            },
            'content/vocabulary/index.html': {
                title: 'German Vocabulary Hub',
                content: 'vocabulary W-words professions food drinks city locations German words vocabulary sections browse',
                url: 'content/vocabulary/index.html'
            },
            'content/vocabulary/w-words-verbs.html': {
                title: 'German W-Words - Complete Reference',
                content: 'W-words Was what Wer who Wen whom accusative Wem whom dative Wessen whose Welche which Wie how Wie viel how much Wie viele how many Warum why Wieso why informal Weshalb why formal Wo where static Wohin where to Woher where from Wodurch through what Worauf on what Worin in what Wobei whereby Wann when specific Wenn when if conditional Wie lange how long Wie oft how often Wie spät what time Wochentag day week Während during Wegen because of Womöglich possibly Weder neither Weiter further Wieder again Wichtig important German question words interrogative pronouns relative pronouns verbs complete reference',
                url: 'content/vocabulary/w-words-verbs.html'
            },
            'content/vocabulary/professions.html': {
                title: 'German Professions',
                content: 'professions jobs careers Sekretär Sekretärin secretary Manager Managerin manager Lehrer Lehrerin teacher Arzt Ärztin doctor Ingenieur Ingenieurin engineer Polizist Polizistin police officer Verkäufer Verkäuferin salesperson Schriftsteller Schriftstellerin writer Journalist Journalistin journalist Bäcker Bäckerin baker Architekt Architektin architect Koch Köchin cook chef Krankenpfleger Krankenschwester nurse Geschäftsmann Geschäftsfrau businessperson Pilot Pilotin pilot Sänger Sängerin singer Friseur Friseurin hairdresser Taxifahrer Taxifahrerin taxi driver Kellner Kellnerin waiter server Flugbegleiter Flugbegleiterin flight attendant Bankangestellte bank employee Schüler Schülerin student Programmierer Programmiererin programmer German occupations work masculine feminine forms',
                url: 'content/vocabulary/professions.html'
            },
            'content/vocabulary/profession_page.html': {
                title: 'German Professions Page',
                content: 'professions jobs careers occupations German work professional vocabulary',
                url: 'content/vocabulary/profession_page.html'
            },
            'content/vocabulary/food_drinks_vehicles.html': {
                title: 'German Food, Drinks & Vehicles',
                content: 'food drinks vehicles Essen eat trinken drink Apfel apple Banane banana Orange orange Erdbeere strawberry Traube grape Birne pear Zitrone lemon Karotte carrot Tomate tomato Kartoffel potato Zwiebel onion Salat lettuce Kohl cabbage Fleisch meat Hähnchen chicken Rindfleisch beef Fisch fish Wurst sausage Ei egg Milch milk Käse cheese Butter butter Joghurt yogurt Brot bread Brötchen roll Reis rice Nudel pasta Wasser water Saft juice Kaffee coffee Tee tea Bier beer Wein wine Auto car Bus bus Zug train Flugzeug airplane Fahrrad bicycle Motorrad motorcycle Schiff ship Boot boat Taxi taxi Straßenbahn tram U-Bahn subway LKW truck lecker delicious gut good schlecht bad süß sweet sauer sour salzig salty scharf spicy heiß hot kalt cold frisch fresh hungrig hungry durstig thirsty satt full kochen cook German vocabulary',
                url: 'content/vocabulary/food_drinks_vehicles.html'
            },
            'content/vocabulary/city-locations.html': {
                title: 'German City Locations',
                content: 'city locations Stadt city Straße street Platz square Park park Bahnhof train station Flughafen airport Kirche church Brücke bridge Landungsbrücke landing bridge Kunsthalle art gallery Bank bank Insel island Bibliothek library Schule school Post post office Autobahn highway Haltestelle bus stop Museum museum Planetarium planetarium Rathaus town hall Theater theater Konzerthaus concert hall Einkaufszentrum shopping center Hotel hotel Krankenhaus hospital Restaurant restaurant Meer sea Denkmal monument Markt market Turm tower Tierpark zoo Zoo zoo Friedhof cemetery Hafen harbor Garten garden Spielplatz playground Fluss river Strand beach Parkplatz parking lot German places urban vocabulary der die das articles',
                url: 'content/vocabulary/city-locations.html'
            },
            'content/vocabulary/german_time_days.html': {
                title: 'German Time & Days',
                content: 'time days Zeit time Uhr clock Uhrzeit time Stunde hour Minute minute Sekunde second Montag Monday Dienstag Tuesday Mittwoch Wednesday Donnerstag Thursday Freitag Friday Samstag Saturday Sonntag Sunday Morgen morning Vormittag forenoon Mittag noon Nachmittag afternoon Abend evening Nacht night heute today gestern yesterday morgen tomorrow jetzt now früh early spät late pünktlich on time drei Uhr three oclock halb vier half past three Viertel nach quarter past Viertel vor quarter to German temporal vocabulary days week',
                url: 'content/vocabulary/german_time_days.html'
            },
            'content/vocabulary/family_classroomArticles.html': {
                title: 'German Family & Classroom Articles',
                content: 'family classroom articles Familie family Vater father Mutter mother Sohn son Tochter daughter Bruder brother Schwester sister Großvater grandfather Großmutter grandmother Onkel uncle Tante aunt Cousin male cousin Cousine female cousin Neffe nephew Nichte niece Ehemann husband Ehefrau wife Schwiegervater father-in-law Schwiegermutter mother-in-law Schwiegersohn son-in-law Schwiegertochter daughter-in-law Enkelsohn grandson Enkeltochter granddaughter Bleistift pencil Kuli ballpoint pen Filzstift felt-tip pen Marker marker Radiergummi eraser Spitzer pencil sharpener Ordner folder Stuhl chair Tisch table Computer computer Taschenrechner calculator Schere scissors Tafel blackboard Tasche bag Büroklammer paper clip Tür door Buch book Heft notebook Wörterbuch dictionary Lineal ruler Mäppchen pencil case Fenster window Name name Vorname first name Nachname last name Alter age Geburtsort birthplace Geburtsdatum date birth Adresse address ledig single verlobt engaged verheiratet married geschieden divorced verwitwet widowed Staatsangehörigkeit nationality Sprachen languages Muttersprache mother tongue Fremdsprache foreign language Beruf profession Ausbildung training Studium studies Student student arbeitslos unemployed German family classroom vocabulary der die das articles',
                url: 'content/vocabulary/family_classroomArticles.html'
            },
            'content/grammar/index.html': {
                title: 'German Grammar Hub',
                content: 'grammar German grammar articles cases irregular verbs sentence structure comprehensive guides examples conjugation tables',
                url: 'content/grammar/index.html'
            },
            'content/grammar/german_articles.html': {
                title: 'German Articles & Cases',
                content: 'articles cases der die das den einen eine ein kein keine keinen definite indefinite negative possessive mein meine meinen dein deine deinen sein seine seinen ihr ihre ihren unser unsere unseren euer eure euren Ihr Ihre Ihren nominative accusative dative genitive Nominativ Akkusativ Bestimmter Artikel Unbestimmter Artikel Negationsartikel Possessiv Artikel Wer oder was Wen oder was German articles cases possessive pronouns declension grammar',
                url: 'content/grammar/german_articles.html'
            },
            'content/grammar/german_irregular_verbs.html': {
                title: 'German Irregular Verbs',
                content: 'irregular verbs fahren drive ich fahre du fährst er fährt wir fahren ihr fahrt sie fahren schlafen sleep ich schlafe du schläfst er schläft wir schlafen ihr schlaft sie schlafen laufen run walk ich laufe du läufst er läuft wir laufen ihr lauft sie laufen sehen see ich sehe du siehst er sieht wir sehen ihr seht sie sehen lesen read ich lese du liest er liest wir lesen ihr lest sie lesen sprechen speak ich spreche du sprichst er spricht wir sprechen ihr sprecht sie sprechen essen eat ich esse du isst er isst wir essen ihr esst sie essen geben give ich gebe du gibst er gibt wir geben ihr gebt sie geben Unregelmäßige Verben Stammwechsel stem change Konjugation conjugation German irregular verbs verb forms strong verbs weak verbs',
                url: 'content/grammar/german_irregular_verbs.html'
            },
            'content/vocabulary/unified_vocabulary_reference.html': {
                title: 'Unified German Vocabulary Reference',
                content: 'unified vocabulary reference complete German words phrases expressions comprehensive guide W-words Wer who Was what Wo where Wann when Wie how Warum why question words interrogative pronouns food drinks Apfel apple Banane banana Wasser water Kaffee coffee vehicles Auto car Bus bus Zug train Flugzeug airplane city locations Bahnhof train station Museum museum Park park time days Montag Monday Dienstag Tuesday Mittwoch Wednesday heute today gestern yesterday morgen tomorrow family Vater father Mutter mother Bruder brother Schwester sister classroom Bleistift pencil Buch book Stuhl chair Tisch table professions Arzt doctor Lehrer teacher Koch chef Verkäufer salesperson pronunciation IPA phonetic transcription articles der die das grammar cases nominative accusative dative genitive German learning vocabulary tables reference guide all categories combined comprehensive complete unified',
                url: 'content/vocabulary/unified_vocabulary_reference.html'
            }
        };

        function performSearch(query) {
            clearTimeout(searchTimeout);
            
            if (!query || query.length < 2) {
                hideSearchResults();
                return;
            }

            searchTimeout = setTimeout(() => {
                const results = searchContent(query.toLowerCase());
                displaySearchResults(results, query);
            }, 300);
        }

        function searchContent(query) {
            const results = [];
            
            Object.entries(pageContent).forEach(([path, page]) => {
                const titleMatch = page.title.toLowerCase().includes(query);
                const contentMatch = page.content.toLowerCase().includes(query);
                
                if (titleMatch || contentMatch) {
                    let relevanceScore = 0;
                    
                    // Higher score for title matches
                    if (titleMatch) relevanceScore += 10;
                    if (contentMatch) relevanceScore += 5;
                    
                    // Higher score for exact word matches
                    const words = query.split(' ');
                    words.forEach(word => {
                        if (word.length > 1) {
                            const regex = new RegExp('\\b' + word + '\\b', 'i');
                            if (regex.test(page.title)) relevanceScore += 5;
                            if (regex.test(page.content)) relevanceScore += 2;
                        }
                    });

                    // Extract relevant snippet
                    const snippet = extractSnippet(page.content, query);
                    
                    results.push({
                        title: page.title,
                        content: snippet,
                        url: page.url,
                        score: relevanceScore
                    });
                }
            });

            // Sort by relevance score
            return results.sort((a, b) => b.score - a.score).slice(0, 8);
        }

        function extractSnippet(content, query) {
            const words = content.split(' ');
            const queryWords = query.toLowerCase().split(' ');
            let bestStart = 0;
            let bestScore = 0;

            // Find the best 15-word snippet that contains query terms
            for (let i = 0; i <= words.length - 15; i++) {
                const snippet = words.slice(i, i + 15).join(' ').toLowerCase();
                let score = 0;
                
                queryWords.forEach(qWord => {
                    if (qWord.length > 1 && snippet.includes(qWord)) {
                        score++;
                    }
                });

                if (score > bestScore) {
                    bestScore = score;
                    bestStart = i;
                }
            }

            const snippet = words.slice(bestStart, bestStart + 15).join(' ');
            return snippet.length > 100 ? snippet.substring(0, 100) + '...' : snippet;
        }

        function displaySearchResults(results, query) {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="no-results">No results found for "' + query + '"</div>';
            } else {
                searchResults.innerHTML = results.map(result => `
                    <div class="search-result-item" onclick="navigateToPage('${result.url}')">
                        <div class="search-result-title">${highlightQuery(result.title, query)}</div>
                        <div class="search-result-content">${highlightQuery(result.content, query)}</div>
                        <div class="search-result-page">${result.url}</div>
                    </div>
                `).join('');
            }
            
            searchResults.style.display = 'block';
        }

        function highlightQuery(text, query) {
            const words = query.split(' ').filter(word => word.length > 1);
            let highlightedText = text;
            
            words.forEach(word => {
                const regex = new RegExp(`(${word})`, 'gi');
                highlightedText = highlightedText.replace(regex, '<strong style="background-color: #fff3cd; color: #856404;">$1</strong>');
            });
            
            return highlightedText;
        }

        function navigateToPage(url) {
            window.location.href = url;
        }

        function hideSearchResults() {
            const searchResults = document.getElementById('searchResults');
            searchResults.style.display = 'none';
        }

        // Hide search results when clicking outside
        document.addEventListener('click', function(event) {
            const searchContainer = document.querySelector('.search-container');
            if (!searchContainer.contains(event.target)) {
                hideSearchResults();
            }
        });

        // Handle search result navigation with keyboard
        document.getElementById('globalSearch').addEventListener('keydown', function(event) {
            const searchResults = document.getElementById('searchResults');
            const resultItems = searchResults.querySelectorAll('.search-result-item');
            
            if (event.key === 'Escape') {
                hideSearchResults();
                this.blur();
            } else if (event.key === 'Enter' && resultItems.length > 0) {
                // Navigate to first result on Enter
                const firstResult = resultItems[0];
                const url = firstResult.getAttribute('onclick').match(/'([^']+)'/)[1];
                navigateToPage(url);
            }
        });
    </script>
</body>
</html>